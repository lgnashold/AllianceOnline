<!doctype html>
<html>
<<<<<<< HEAD
  <head>
    <title> Alliance -- Join Game </title>
    <link rel = "stylesheet" href = "{{ url_for('static', filename='style.css') }}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.dev.js"> </script>

  </head>
  <body>
    <div id = "info">
    <div style = "float:right:">
      <button  onclick = "endTurn()"> End Turn </button>
      <p>Change Team:</p>
      <p>
        <button style = " width: 50px; height: 50px; background-color: {{team_colors.team1}}" onclick = "change_team('team1')">Join</button>
        <button style = " width: 50px; height: 50px; background-color: {{team_colors.team2}}" onclick = "change_team('team2')">Join</button>
        <button style = "width: 50px; height: 50px; background-color: {{team_colors.team3}}" onclick = "change_team('team3')">Join</button>
        <button style = "width: 50px; height: 50px;background-color: {{team_colors.team4}}" onclick = "change_team('team4')">Join</button>
      </p>
      <p id = "player1"></id>
      <p id = "player2"></id>
      <p id = "player3"></id>
      <p id = "player4"></id>

    </div>
=======
<head>
  <title> Alliance -- Join Game </title>
  <link rel = "stylesheet" href = "{{ url_for('static', filename='style.css') }}">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src = "https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.dev.js"> </script>
>>>>>>> 218ebaad1b4b55db41b1e52ca08c8122ae6641b8

</head>
<body>
  <div id = "info">

    <h1> Play Alliance </h1>
    <p> <b> Room: </b> {{join_code}} </p>
    <p> <b> Nickname: </b> {{nickname}} </p>

    <button  onclick = "endTurn()"> End Turn </button>
    <p>
      <button style = " width: 50px; height: 50px; background-color: {{team_colors.team1}}" onclick = "change_team('team1')">Join</button>
      <button style = " width: 50px; height: 50px; background-color: {{team_colors.team2}}" onclick = "change_team('team2')">Join</button>
      <button style = "width: 50px; height: 50px; background-color: {{team_colors.team3}}" onclick = "change_team('team3')">Join</button>
      <button style = "width: 50px; height: 50px;background-color: {{team_colors.team4}}" onclick = "change_team('team4')">Join</button>
    </p>
    <p id = "player1"></p>
    <p id = "player2"></p>
    <p id = "player3"></p>
    <p id = "player4"></p>

    <div id = "log" class = "log-area">
      <!--Log Messages will be added here -->
    </div>
  <div id = "board">
    <canvas id = "gameCanvas" style = "background-color:lightgray">Your browser does not support HTML5 Canvas</canvas>
    <script src = "{{ url_for('static', filename='board.js') }}"> </script>
    <script>
    console.log("connected");

    var socket = io.connect("/game");

    //when you recieve a message append it to the log

    socket.on("update_board",function(msg) {
      if(msg.room == "{{join_code}}") {
        console.log("recieved: " + msg);
        boardPos = JSON.parse(msg.board);
        console.log(boardPos);
        draw_board();
      }
    });

    socket.on('message', function(msg) {
      if(msg.room == "{{join_code}}") {
        $('#log').prepend('<p>' + msg.data + '</p>');
      }
    });

    socket.on('update_money', function(msg) {
      if(msg.room == "{{join_code}}") {
        console.log("players: " + msg.data);
        options = Object.keys(msg.data);
        for(var i = 0; i < options.length; i++) {
          if(msg.data[options[i]] != null) {
            console.log("worked");
            $("#"+options[i]).text("Name: "+msg.data[options[i]].nickname + " Money: " + msg.data[options[i]].money);
          }
        }
      }
    });

    socket.on('update_players', function(msg) {
      if(msg.room == "{{join_code}}") {
        console.log("players: " + msg.data);
        options = Object.keys(msg.data);
        for(var i = 0; i < options.length; i++) {
          if(msg.data[options[i]] != null) {
            console.log("worked");
            $("#"+options[i]).text("Money: " + msg.data[options[i]].money);
          }
        }
      }
    });

    function change_team(teamToChange) {
      socket.emit('change_team', {team: teamToChange});
    }

    function endTurn() {
      socket.emit('end_turn');
    }

    function makeMove(iPos,jPos) {
      console.log("emit move " + iPos + " "+ jPos);
      socket.emit('make_move', {i:iPos,j:jPos});
    }
    </script>
  </div>
</body>
</html>
